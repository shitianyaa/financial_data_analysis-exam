# A股行业板块轮动分析系统

## 项目概述

本项目是一个完整的A股行业板块轮动分析系统，包含基础数据分析、估值分析、回测分析和相关性分析四大模块。系统使用Tushare Pro API获取真实金融数据，支持数据缓存和用户交互选择。

## 文件结构

```
金融数据分析/
├── data/                    # 数据文件夹
│   ├── cache_医药生物.csv
│   ├── cache_半导体.csv
│   ├── cache_新能源.csv
│   ├── cache_有色金属.csv
│   ├── cache_沪深300.csv
│   ├── cache_银行.csv
│   ├── cache_食品饮料.csv
│   ├── sector_data_cache.csv
│   ├── valuation_data_cache.csv
│   └── 完整季度收益率.csv
├── 1_基础数据分析.py        # 基础数据获取与季度轮动分析
├── 2_估值分析.py           # 申万行业估值维度分析
├── 3_回测分析.py           # 多因子增强版回测系统
├── 4_滚动相关性分析.py      # 滚动相关性分析模块
├── 5_指标表格.py           # 定制化报表输出
├── README.md               # 项目说明文档
└── .env                    # Tushare Token配置文件
```

## 运行环境要求

- Python 3.7+
- 必需库：tushare, pandas, numpy, matplotlib, seaborn, scipy
- Tushare Pro账号（需要5000积分）

## 安装依赖

```bash
pip install tushare pandas numpy matplotlib seaborn scipy
```

## 配置说明

### 1. Tushare Token配置

在项目根目录创建 `.env` 文件，内容如下：

```
TUSHARE_TOKEN=your_tushare_token_here
```

**重要：** 需要Tushare Pro账号并拥有5000积分才能使用sw_daily接口。

### 2. 数据缓存机制

- 系统会自动缓存获取的数据到CSV文件
- 缓存数据有效期为7天
- 用户可选择使用缓存数据或重新获取最新数据

## 运行顺序

**请严格按照以下顺序运行各模块：**

### 第一步：基础数据分析
```bash
python "1_基础数据分析.py"
```

**生成图片：**
- `images/1_累计收益率.png` - 行业累计收益率走势图
- `images/2_风险收益.png` - 风险收益气泡图
- `images/3_季度轮动_全景热力图.png` - 全历史季度热力图
- `images/4_季度轮动_最近9季详情.png` - 最近9个季度详情网格图

**输出文件：**
- `sector_data_cache.csv` - 行业数据缓存
- `完整季度收益率.csv` - 季度收益率数据

### 第二步：估值分析
```bash
python "2_估值分析.py"
```

**生成图片：**
- `images/5_板块估值分析_SW.png` - 申万行业PE与历史分位对比图

**输出文件：**
- `valuation_data_cache.csv` - 估值数据缓存

### 第三步：回测分析
```bash
python "3_回测分析.py"
```

**生成图片：**
- `images/6_高级回测分析.png` - 多因子回测分析图

### 第四步：滚动相关性分析
```bash
python "4_滚动相关性分析.py"
```

**生成图片：**
- `images/7_滚动相关性分析.png` - 新能源vs半导体60日动态相关性图

## 运行结果说明

### 基础数据分析模块

**功能：**
- 获取申万一级行业历史数据（2022-2025）
- 计算年化收益率、波动率、夏普比率
- 生成季度收益率热力图
- 统计季度领涨板块

**关键输出：**
- 累计收益率走势图：展示各行业相对收益表现
- 风险收益气泡图：直观显示风险收益特征
- 季度热力图：展示行业轮动规律
- 季度冠军统计：分析领涨板块特征

### 估值分析模块

**功能：**
- 获取申万行业PE、PB估值数据
- 计算历史分位数（过去5年）
- 估算PEG指标
- 支持数据缓存和用户交互

**分析行业：**
- 新能源、半导体、医药生物、食品饮料、银行、有色金属

**关键指标：**
- PE历史分位：当前PE在历史中的位置
- PB历史分位：当前PB在历史中的位置
- PEG：PE与预估增长率的比值

### 回测分析模块

**策略特点：**
- 多因子选股（动量/技术/估值）
- 市场状态识别（牛市/震荡市择时）
- 动态权重调整

**因子权重：**
- 牛市：动量50% + 技术30% + 估值20%
- 震荡市：动量30% + 技术30% + 估值40%

### 滚动相关性分析模块

**分析内容：**
- 新能源vs半导体60日动态相关性
- 相关性趋势分析
- 市场联动性研究

## 注意事项

### 重要提醒

1. **运行顺序必须严格遵守**：各模块之间存在数据依赖关系
2. **Tushare积分要求**：估值分析模块需要5000积分才能使用sw_daily接口
3. **数据缓存**：系统会自动缓存数据，避免重复调用API
4. **时间范围**：数据获取时间范围为2022年1月1日至2025年12月26日

### 常见问题

**Q: 运行时报错"找不到.env文件"**
A: 请确保项目根目录存在.env文件，并正确配置TUSHARE_TOKEN

**Q: 估值分析模块无法获取数据**
A: 请确认Tushare账号拥有5000积分，积分可在tushare.pro个人主页查看

**Q: 图片命名冲突**
A: 已修复所有图片命名顺序问题，请按正确顺序运行各模块

**Q: 数据缓存过期**
A: 缓存数据有效期为7天，过期后系统会提示重新获取

### 数据安全

- 敏感信息（Token）存储在.env文件中
- 缓存数据仅包含公开的行业数据
- 不存储任何个人账户信息

## 技术特点

### 代码规范
- 模块化设计，功能清晰分离
- 完善的错误处理和用户交互
- 支持中文字符显示
- 统一的图片命名规范

### 数据分析方法
- 使用对数收益率计算
- 采用滚动窗口分析
- 支持多时间维度分析
- 结合定量和定性分析

### 可视化效果
- 专业级的图表设计
- 支持中文标签显示
- 统一的配色方案
- 高分辨率输出（300dpi）

## 学术价值

本项目为金融数据分析提供了完整的分析框架，特别适合：
- 行业轮动策略研究
- 估值体系分析
- 多因子模型验证
- 市场相关性研究

## 更新日志

### 2025-12-28
- 修复图片命名顺序错误
- 完善数据缓存机制
- 优化用户交互体验
- 更新项目文档

## 联系方式

如有问题或建议，请联系项目维护者。

---

**免责声明：本项目仅供学术研究使用，不构成投资建议。投资有风险，入市需谨慎。**